<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>04 MongoDB 笔记 | coo1heisenberg's Blog</title><noscript>开启JavaScript才能访问本站哦~</noscript><link rel="icon" href="/img/pwa/favicon.ico"><!-- index.css--><link rel="stylesheet" href="/css/index.css?v=1.10.6"><!-- inject head--><link rel="stylesheet" href="https://cdn2.codesign.qq.com/icons/7pOrz0WXB5ZWJPX/latest/iconfont.css"><!-- aplayer--><link rel="stylesheet" href="//open.lightxi.com/cdnjs/ajax/libs/aplayer/1.10.1/APlayer.min.css"><!-- swiper--><link rel="stylesheet" href="//open.lightxi.com/cdnjs/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"><!-- fancybox ui--><!-- katex--><link rel="stylesheet" href="//open.lightxi.com/cdnjs/ajax/libs/KaTeX/0.16.9/katex.min.css"><!-- Open Graph--><meta name="description" content="MongoDB MongoDB 相关概念 传统的关系型数据库（如MySQL），在数据操作的 “三高” 需求以及应对 Web2.0 的网站需求面前，显得力不从心。 解释 “三高” 需求： High performance：对数据库 高并发 读写的需求 Huge Storage：对海量数据的 高"><!-- pwa--><meta name="apple-mobile-web-app-capable" content="coo1heisenberg's Blog"><meta name="theme-color" content="var(--efu-main)"><meta name="apple-mobile-web-app-status-bar-style" content="var(--efu-main)"><link rel="bookmark" href="/img/pwa/favicon.ico"><link rel="apple-touch-icon" href="/img/pwa/favicon.ico" sizes="180x180"><script>console.log(
    "%c Program: Hexo %c Theme: Solitude %c Version: v1.10.6",
    "border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#ff3842;",
    "padding: 5px 10px;color:white;background:#3e9f50;",
    "padding: 5px 10px;color:white;background:#0084ff;border-radius:0 5px 5px 0",
)
</script><script>(()=>{
        const saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay
                }
                localStorage.setItem(key, JSON.stringify(item))
            },
            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)
    
                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()
    
                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        };
        window.utils = {
            saveToLocal: saveToLocal,
            getCSS: (url, id = false) => new Promise((resolve, reject) => {
              const link = document.createElement('link')
              link.rel = 'stylesheet'
              link.href = url
              if (id) link.id = id
              link.onerror = reject
              link.onload = link.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                link.onload = link.onreadystatechange = null
                resolve()
              }
              document.head.appendChild(link)
            }),
            getScript: (url, attr = {}) => new Promise((resolve, reject) => {
              const script = document.createElement('script')
              script.src = url
              script.async = true
              script.onerror = reject
              script.onload = script.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                script.onload = script.onreadystatechange = null
                resolve()
              }
    
              Object.keys(attr).forEach(key => {
                script.setAttribute(key, attr[key])
              })
    
              document.head.appendChild(script)
            }),
            addGlobalFn: (key, fn, name = false, parent = window) => {
                const globalFn = parent.globalFn || {}
                const keyObj = globalFn[key] || {}
        
                if (name && keyObj[name]) return
        
                name = name || Object.keys(keyObj).length
                keyObj[name] = fn
                globalFn[key] = keyObj
                parent.globalFn = globalFn
            },
        }
    })()</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: undefined,
    localsearch: {"preload":false,"path":"/search.xml"},
    runtime: '2024-05-12 00:00:00',
    lazyload: {
        enable: false,
        error: '/img/error_load.webp'
    },
    copyright: {"limit":50,"author":"作者: Coo1heisenberg’s BLOG","link":"链接: ","source":"来源: coo1heisenberg's Blog","info":"著作权归作者所有。 商业转载请联系作者获得授权，非商业转载请注明出处。"},
    highlight: {
        enable: true,
        limit: 200,
        expand: true,
        copy: true,
        syntax: 'highlight.js'
    },
    randomlink: false,
    lang: {"theme":{"dark":"已切换至深色模式","light":"已切换至浅色模式"},"copy":{"success":"复制成功","error":"复制失败"},"backtop":"返回顶部","time":{"day":"天前","hour":"小时前","just":"刚刚","min":"分钟前","month":"个月前"},"f12":"开发者模式已打开，请遵循GPL协议。","totalk":"无需删除空行，直接输入评论即可","search":{"empty":"找不到你查询的内容：${query}","hit":"找到 ${hits} 条结果，用时 ${time} 毫秒","placeholder":"输入关键词快速查找","count":"共 <b>${count}</b> 条结果。"}},
    aside: {
        sayhello: {
            morning: '一日之计在于晨',
            noon: '吃饱了才有力气干活',
            afternoon: '集中精力，攻克难关',
            night: '不要太劳累了，早睡更健康',
            goodnight: '睡个好觉，保证精力充沛',
        },
        sayhello2: [],
    },
    covercolor: {
        enable: false
    },
    comment: false,
    lightbox: 'null',
    post_ai: false,
    right_menu: false,
};</script><!-- page-config head--><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: '',
    toc: true,
    comment: false,
    ai_text: false
}</script><meta name="generator" content="Hexo 7.2.0"></head><body id="body"><!-- universe--><canvas id="universe"></canvas><!-- loading--><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="solitude st-close-fill"></i></div><div class="console-card-group"><div class="console-card-group-right"><div class="console-card tags" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">标签</div><div class="author-content-item-title">寻找感兴趣的领域</div></div><div class="card-tag-cloud"><a href="/tags/Python%E9%AB%98%E7%BA%A7/">Python高级<sup>1</sup></a><a href="/tags/Docker%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Docker基础语法<sup>1</sup></a><a href="/tags/JavaEE/">JavaEE<sup>6</sup></a><a href="/tags/Nginx%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Nginx基础语法<sup>1</sup></a><a href="/tags/Spring/">Spring<sup>7</sup></a><a href="/tags/MongoDB/">MongoDB<sup>1</sup></a><a href="/tags/Redis/">Redis<sup>2</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式<sup>1</sup></a><a href="/tags/Java-Basic/">Java Basic<sup>4</sup></a><a href="/tags/Linux%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Linux基础语法<sup>1</sup></a><a href="/tags/Mybatis-Plus/">Mybatis-Plus<sup>1</sup></a><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务<sup>1</sup></a><a href="/tags/ElasticSearch/">ElasticSearch<sup>1</sup></a><a href="/tags/Python%E5%9F%BA%E7%A1%80/">Python基础<sup>2</sup></a><a href="/tags/MySQL/">MySQL<sup>1</sup></a><a href="/tags/Project/">Project<sup>2</sup></a><a href="/tags/%E5%8D%95%E7%BB%86%E8%83%9E/">单细胞<sup>1</sup></a></div></div><div class="console-card history" onclick="sco.hideConsole()"><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">2024/09</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">2024/08</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">2024/07</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">2024/06</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">2024/05</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">17</span><span class="card-archive-list-count-unit">篇</span></div></a></li></ul></div></div></div><div class="button-group"><div class="console-btn-item"><span class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="昼夜切换"><i class="solitude st-moon-clear-fill"></i></span></div><div class="console-btn-item" id="consoleHideAside"><span class="asideSwitch" onclick="sco.switchHideAside()" title="边栏显示控制"><i class="solitude st-side-bar-fill"></i></span></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">33</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><span class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()"><i class="solitude st-moon-clear-fill"></i><span>显示模式</span></span></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">博客主题</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/valor-x/hexo-theme-solitude" title="Solitude"><img class="nolazyload back-menu-item-icon" src="https://7.isyangs.cn/1/65eb200ee4dea-1.png" alt="Solitude"><span class="back-menu-item-text">Solitude</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/links/"><i class="solitude  st-group-fill"></i><span>友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/tlink/"><i class="solitude  st-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"><a href="/tags/Python%E9%AB%98%E7%BA%A7/">Python高级<sup>1</sup></a><a href="/tags/Docker%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Docker基础语法<sup>1</sup></a><a href="/tags/JavaEE/">JavaEE<sup>6</sup></a><a href="/tags/Nginx%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Nginx基础语法<sup>1</sup></a><a href="/tags/Spring/">Spring<sup>7</sup></a><a href="/tags/MongoDB/">MongoDB<sup>1</sup></a><a href="/tags/Redis/">Redis<sup>2</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式<sup>1</sup></a><a href="/tags/Java-Basic/">Java Basic<sup>4</sup></a><a href="/tags/Linux%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">Linux基础语法<sup>1</sup></a><a href="/tags/Mybatis-Plus/">Mybatis-Plus<sup>1</sup></a><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务<sup>1</sup></a><a href="/tags/ElasticSearch/">ElasticSearch<sup>1</sup></a><a href="/tags/Python%E5%9F%BA%E7%A1%80/">Python基础<sup>2</sup></a><a href="/tags/MySQL/">MySQL<sup>1</sup></a><a href="/tags/Project/">Project<sup>2</sup></a><a href="/tags/%E5%8D%95%E7%BB%86%E8%83%9E/">单细胞<sup>1</sup></a></div></div></div></div><!-- keyboard--><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon solitude st-more-fill"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">博客主题</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/valor-x/hexo-theme-solitude" title="Solitude"><img class="nolazyload back-menu-item-icon" src="https://7.isyangs.cn/1/65eb200ee4dea-1.png" alt="Solitude"><span class="back-menu-item-text">Solitude</span></a></div></div></div></div><a id="site-name" href="/" title="返回博客主页"><span class="title">Solitude</span></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">04 MongoDB 笔记</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/links/"><i class="solitude  st-group-fill"></i><span>友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/tlink/"><i class="solitude  st-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button" id="travellings_button"><a class="site-page" href="/" title=""><i class="solitude st-train-line"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索"><i class="solitude st-search-line"></i></a></div><div class="nav-button" id="nav-totop" onclick="sco.toTop()"><a class="totopbtn"><i class="solitude st-arrow-up-line"></i><span id="percent">0</span></a></div><div id="toggle-menu"><a class="site-page"><i class="solitude st-menu-line"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/Mongodb_title.png" alt="04 MongoDB 笔记"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="该文章为原创文章，注意版权协议">原创</a><span class="post-meta-categories"><a class="post-meta-categories" href="/categories/Database/">Database</a></span><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MongoDB/"><span class="tags-name tags-punctuation">MongoDB</span></a></div></div></div></div><h1 class="post-title">04 MongoDB 笔记</h1><div id="post-meta"><div class="meta-secondline"><span class="post-meta-date" title="发布于 2024-07-22 23:22:11"><i class="post-meta-icon solitude st-calendar-todo-fill"></i><time datetime="2024-07-22T15:22:11.000Z">2024-07-22T15:22:11.000Z</time></span><span class="post-meta-date" title="最后更新于 2024-07-24 20:50:20"><i class="post-meta-icon solitude st-refresh-line"></i><time datetime="2024-07-24T12:50:20.617Z">2024-07-24T12:50:20.617Z</time></span><span class="post-meta-wordcount"><span class="post-meta-separator"></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>MongoDB</h1>
<hr>
<h2 id="MongoDB-相关概念"><a class="headerlink" href="#MongoDB-相关概念"></a>MongoDB 相关概念</h2>
<hr>
<p>传统的关系型数据库（如MySQL），在数据操作的 “三高” 需求以及应对 Web2.0 的网站需求面前，显得力不从心。</p>
<ul>
<li>解释 “三高” 需求：
<ul>
<li><strong>High performance</strong>：对数据库 高并发 读写的需求</li>
<li><strong>Huge Storage</strong>：对海量数据的 高效率存储和访问 的需求</li>
<li><strong>High Scalability &amp;&amp; High Availability</strong>：对数据库的 高可扩展性和高可用性 的需求</li>
</ul>
</li>
</ul>
<p>而 <strong>MongoDB可应对“三高”需求</strong></p>
<p>具体的应用场景如：</p>
<ul>
<li><strong>社交场景</strong>，使用 MongoDB 存储存储用户信息，以及用户发表的朋友圈信息，通过地理位置索引实现附近的人、地点等功能</li>
<li><strong>游戏场景</strong>，使用 MongoDB 存储游戏用户信息，用户的装备、积分等直接以内嵌文档的形式存储，方便查询、高效率存储和访问</li>
<li><strong>物流场景</strong>，使用 MongoDB 存储订单信息，订单状态在运送过程中会不断更新，以 MongoDB 内嵌数组的形式来存储，一次查询就能将 订单所有的变更读取出来</li>
<li><strong>物联网场景</strong>，使用 MongoDB 存储所有接入的智能设备信息，以及设备汇报的日志信息，并对这些信息进行多维度的分析</li>
<li><strong>视频直播</strong>，使用 MongoDB 存储用户信息、点赞互动信息等</li>
</ul>
<p>这些应用场景中，数据操作方面的共同特点是：</p>
<ol>
<li><strong>数据量大</strong></li>
<li><strong>写入操作频繁</strong>（<strong>读写都很频繁</strong>）</li>
<li><strong>价值较低的数据，对 事务性 要求不高</strong></li>
</ol>
<p>对于这样的数据更适合使用 MongoDB 来实现数据的存储。</p>
<p>选用MongoDB的场景：</p>
<p>在架构选型上，除了上述的三个特点外，可以考虑以下的一些问题：</p>
<ul>
<li>应用 <strong>不需要事务 及复杂 join 支持</strong></li>
<li>新应用，需求会变，<strong>数据模型无法确定</strong>，想快速迭代开发</li>
<li>应用需要 2000-3000 以上的读写QPS（更高也可以）</li>
<li>应用需要 TB 甚至 PB 级别数据存储</li>
<li>应用发展迅速，需要能快速水平扩展</li>
<li>应用要求存储的数据不丢失</li>
<li>应用需要 99.999% 高可用</li>
<li>应用需要大量的地理位置查询、文本查询</li>
</ul>
<hr>
<h2 id="MongoDB-简介"><a class="headerlink" href="#MongoDB-简介"></a>MongoDB 简介</h2>
<hr>
<p>MongoDB 是一个 <strong>开源、高性能、无模式</strong> 的 文档型数据库，当初的设计就是用于简化开发和方便扩展，是 NoSQL数据库产品中的一种。是 <strong>最像关系型数据库（MySQL）的非关系型数据库</strong></p>
<p>它支持的数据结构非常松散，是一种类似于 JSON 的 格式叫 <strong>BSON</strong>，所以它 <strong>既可以存储比较复杂的数据类型，又相当的灵活</strong></p>
<p>MongoDB中的记录是一个文档，它是一个由 字段和值对（<code>field:value</code>）组成的数据结构。MongoDB文档类似于JSON对象，即一个文档认为就是一个对象。字段的数据类型是 字符型，它的值除了使用基本的一些类型外，还可以包括其他文档、普通数组和文档数组</p>
<p><img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723090054039.png" alt="MySQLvsMongoDB" loading="lazy"></p>
<p><img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723090342383.png" alt="MySQL与MongoDB之间的关系" loading="lazy"></p>
<hr>
<h2 id="MongoDB-数据模型"><a class="headerlink" href="#MongoDB-数据模型"></a>MongoDB 数据模型</h2>
<hr>
<p>MongoDB的最小存储单位就是 <strong>文档(document)对象</strong></p>
<ul>
<li>文档(document)对象对应于关系型数据库的行</li>
<li>数据在MongoDB中以 <strong>BSON（Binary-JSON）文档</strong> 的格式存储在磁盘上</li>
</ul>
<p>BSON（Binary Serialized Document Format）是一种 <strong>类 json 的一种二进制形式的存储格式</strong>，简称 Binary JSON</p>
<ul>
<li>BSON 和 JSON 一样，支持 内嵌的文档对象和数组对象，但是 BSON 有 JSON 没有的一些数据类型，如Date 和 BinData 类型</li>
<li>BSON 采用了 <strong>类似于 C 语言结构体的名称、对表示方法，支持内嵌的文档对象和数组对象，具有轻量性、可遍历性、高效性的三个特点</strong>，可以有效描述非结构化数据和结构化数据。这种格式的优点是灵活性高，但它的缺点是空间利用率不是很理想</li>
<li>BSON 中，除了基本的JSON类型：<code>string</code>、<code>integer</code>、<code>boolean</code>、<code>double</code>、<code>null</code>、<code>array</code> 和 <code>object</code>，mongo 还使用了特殊的数据类型。这些类型包括：<code>date</code>、<code>object id</code>、<code>binary data</code>、<code>regular expression</code> 和 <code>code</code>。每一个驱动都 以特定语言的方式 实现了这些类型，查看你的驱动的文档来获取详细信息</li>
</ul>
<p><img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723091101934.png" alt="BSON数据类型参考列表" loading="lazy"></p>
<hr>
<h2 id="MongoDB-特点"><a class="headerlink" href="#MongoDB-特点"></a>MongoDB 特点</h2>
<hr>
<ol>
<li><strong>高性能</strong>：MongoDB提供 高性能的数据持久性
<ul>
<li>特别是, 对 嵌入式数据模型 的支持减少了数据库系统上的 I/O 活动</li>
<li>索引支持更快的查询，并且可以包含来自嵌入式文档和数组的键（文本索引解决搜索的需求、TTL索引解决历史数据自动过期的需求、地理位置索引可用于构建各种 O2O 应用）</li>
<li>mmapv1、wiredtiger、mongorocks（rocksdb）、in-memory 等多引擎支持满足各种场景需求。</li>
<li>Gridfs 解决文件存储的需求</li>
</ul>
</li>
<li><strong>高可用性</strong>：MongoDB的复制工具称为副本集（replica set），它可提供自动故障转移和数据冗余</li>
<li><strong>高扩展性</strong>：MongoDB提供了水平可扩展性作为其核心功能的一部分。 分片将数据分布在一组集群的机器上。（海量数据存储，服务能力水平扩展） 从3.4开始，MongoDB支持基于片键创建数据区域。在一个平衡的集群中，MongoDB将一个区域所覆盖的读写只定向到该区域内的那些 片</li>
<li><strong>丰富的查询支持</strong>：MongoDB支持丰富的查询语言，支持读和写操作(CRUD)，比如：数据聚合、文本搜索和地理空间查询等</li>
<li>其他特点：如 <strong>无模式（动态模式）、灵活的文档模型</strong></li>
</ol>
<hr>
<h2 id="基本常用命令"><a class="headerlink" href="#基本常用命令"></a>基本常用命令</h2>
<hr>
<p>举例：数据库 articledb</p>
<p><img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723094107111.png" alt="articledb" loading="lazy"></p>
<hr>
<h3 id="选择-和-创建-数据库"><a class="headerlink" href="#选择-和-创建-数据库"></a>选择 和 创建 数据库</h3>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名称</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>如果 数据库不存在 则 自动创建</strong>，但是 use 创建的数据库并没有真正创建，而是在内存中，并没有持久化到磁盘，<strong>只有在创建数据表后要再插入一个文档（记录），数据库才会真正创建</strong></li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use articledb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> use articledb</span><br><span class="line">switched <span class="keyword">to</span> db articledb</span><br></pre></td></tr></table></figure>
<p><strong>查看 所有的数据库 命令</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> dbs</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">show</span> databases</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">show</span> dbs</span><br><span class="line">admin   <span class="number">0.000</span>GB</span><br><span class="line">config  <span class="number">0.000</span>GB</span><br><span class="line"><span class="keyword">local</span>   <span class="number">0.000</span>GB</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>admin</strong>： 从权限的角度来看，这是 “root” 数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如：列出所有的数据库或者关闭服务器</li>
<li><strong>local</strong>：这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合，在集群中使用较多</li>
<li><strong>config</strong>：当 Mongo 用于分片设置时，config 数据库在内部使用，用于保存分片的相关信息</li>
</ul>
<p><strong>查看 当前正在使用的数据库 命令</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db</span><br><span class="line">articledb</span><br></pre></td></tr></table></figure>
<p>另外： 数据库名可以是满足以下条件的任意 UTF-8 字符串</p>
<ul>
<li>不能是空字符串（<code>&quot;&quot;</code>)</li>
<li>不得含有 <code>' '</code>（空格)、<code>.</code>、<code>$</code>、<code>/</code>、<code>\</code> 和 <code>\0</code> (空字符)</li>
<li>应全部小写</li>
<li>最多 64 字节</li>
</ul>
<hr>
<h3 id="删除-数据库"><a class="headerlink" href="#删除-数据库"></a>删除 数据库</h3>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.dropDatabase()</span><br></pre></td></tr></table></figure>
<ul>
<li>提示：主要用来 <strong>删除已经持久化的数据库</strong></li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.dropDatabase()</span><br><span class="line">&#123; &quot;ok&quot; : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="集合-操作"><a class="headerlink" href="#集合-操作"></a>集合 操作</h3>
<hr>
<p>集合，<strong>类似关系型数据库中的 表</strong></p>
<hr>
<h4 id="集合-的-显式创建"><a class="headerlink" href="#集合-的-显式创建"></a>集合 的 显式创建</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(name)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>name</code>：要创建的集合名称</li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.createCollection(&quot;mycollection&quot;)</span><br><span class="line">&#123; &quot;ok&quot; : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="集合-的-删除"><a class="headerlink" href="#集合-的-删除"></a>集合 的 删除</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.drop()</span><br><span class="line">或者</span><br><span class="line">db.集合名称.<span class="keyword">drop</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>返回值说明</strong>：如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false</li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.mycollection.drop()</span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="文档基本-CRUD"><a class="headerlink" href="#文档基本-CRUD"></a>文档基本 CRUD</h3>
<hr>
<p>文档（document）的数据结构和 JSON 基本一样</p>
<p>所有存储在集合中的数据都是 BSON 格式</p>
<hr>
<h4 id="文档-的-插入"><a class="headerlink" href="#文档-的-插入"></a>文档 的 插入</h4>
<hr>
<p><strong>单个文档的插入</strong>：</p>
<p>使用 <strong>insert()</strong> 或 <strong>save()</strong> 方法向集合中插入文档</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.collection.insert(</span><br><span class="line">	<span class="operator">&lt;</span>document <span class="keyword">or</span> <span class="keyword">array</span> <span class="keyword">of</span> documents<span class="operator">&gt;</span>,</span><br><span class="line">	&#123;</span><br><span class="line">		writeConcern: <span class="operator">&lt;</span>document<span class="operator">&gt;</span>,</span><br><span class="line">		ordered: <span class="operator">&lt;</span><span class="type">boolean</span><span class="operator">&gt;</span></span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>参数说明</strong>：<img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723101825675.png" alt="参数说明" loading="lazy"></li>
</ul>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.insert(&#123;&quot;articleid&quot;:<span class="number">100000</span>, &quot;content&quot;:&quot;今天天气真不错&quot;, &quot;userid&quot;:&quot;1001&quot;,&quot;nickname&quot;:&quot;阿三&quot;,&quot;createtime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(), &quot;likenum&quot;:NumberInt(<span class="number">10</span>),&quot;state&quot;:<span class="keyword">null</span>&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nInserted&quot; : <span class="number">1</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>查询是否插入成功：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;669f14e2a7618ffe66c5ede6&quot;), &quot;articleid&quot; : <span class="number">100000</span>, &quot;content&quot; : &quot;今天天气真不错&quot;, &quot;userid&quot; : &quot;1001&quot;, &quot;nickname&quot; : &quot;阿三&quot;, &quot;createtime&quot; : ISODate(&quot;2024-07-23T02:26:42.701Z&quot;), &quot;likenum&quot; : <span class="number">10</span>, &quot;state&quot; : <span class="keyword">null</span> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>说明</strong>：</p>
<ol>
<li>comment 集合如果不存在，则会隐式创建</li>
<li>mongo 中的数字，默认情况下是 double 类型，如果要存整型，必须使用函数 NumberInt (整型数字)，否则取出来就有问题了</li>
<li>插入当前日期使用 new Date()</li>
<li>插入的数据没有指定 _id ，会自动生成主键值</li>
<li>如果某字段没值，可以赋值为 null，或不写该字段</li>
</ol>
<p><strong>批量插入</strong>：</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.collection.insertMany(</span><br><span class="line">	[ <span class="operator">&lt;</span>document <span class="number">1</span><span class="operator">&gt;</span> , <span class="operator">&lt;</span>document <span class="number">2</span><span class="operator">&gt;</span>, ... ],</span><br><span class="line">	&#123;</span><br><span class="line">		writeConcern: <span class="operator">&lt;</span>document<span class="operator">&gt;</span>,</span><br><span class="line">		ordered: <span class="operator">&lt;</span><span class="type">boolean</span><span class="operator">&gt;</span></span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.insertMany([</span><br><span class="line">... &#123;&quot;_id&quot;:&quot;1&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我们不应该把清晨浪费在手机上，健康很重要，一杯温水幸福你我他。&quot;,&quot;userid&quot;:&quot;1002&quot;,&quot;nickname&quot;:&quot;相忘于江湖&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-05T22:08:15.522Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">1000</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">... &#123;&quot;_id&quot;:&quot;2&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我夏天空腹喝凉开水，冬天喝温开水&quot;,&quot;userid&quot;:&quot;1005&quot;,&quot;nickname&quot;:&quot;伊人憔悴&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-05T23:58:51.485Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">888</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">... &#123;&quot;_id&quot;:&quot;3&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我一直喝凉开水，冬天夏天都喝。&quot;,&quot;userid&quot;:&quot;1004&quot;,&quot;nickname&quot;:&quot;杰克船长&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T01:05:06.321Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">666</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">... &#123;&quot;_id&quot;:&quot;4&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;专家说不能空腹吃饭，影响健康。&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;凯撒&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T08:18:35.288Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">2000</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">... &#123;&quot;_id&quot;:&quot;5&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;研究表明，刚烧开的水千万不能喝，因为烫嘴。&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;凯撒&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T11:01:02.521Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">3000</span>),&quot;state&quot;:&quot;1&quot;&#125;</span><br><span class="line">... ]);</span><br><span class="line">&#123;</span><br><span class="line">	&quot;acknowledged&quot; : <span class="literal">true</span>,</span><br><span class="line">	&quot;insertedIds&quot; : [</span><br><span class="line">		&quot;1&quot;,</span><br><span class="line">		&quot;2&quot;,</span><br><span class="line">		&quot;3&quot;,</span><br><span class="line">		&quot;4&quot;,</span><br><span class="line">		&quot;5&quot;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>插入时指定了 _id ，则主键就是该值</li>
<li>如果某条数据插入失败，将会终止插入，但已经插入成功的数据不会回滚掉</li>
<li>因为批量插入由于数据较多容易出现失败，因此，可以使用 try catch 进行异常捕捉处理，测试的时候可以不处理</li>
</ul>
<hr>
<h4 id="文档-的-基本查询"><a class="headerlink" href="#文档-的-基本查询"></a>文档 的 基本查询</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(<span class="operator">&lt;</span>query<span class="operator">&gt;</span>, [projection])</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>参数说明</strong>：<img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240723105355080.png" alt="参数说明" loading="lazy"></li>
</ul>
<p>eg：</p>
<ul>
<li>
<p><strong>查询所有</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find()</span><br><span class="line">或者</span><br><span class="line">db.comment.find(&#123;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>按一定条件来查询</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&quot;1003&quot;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>查询并只需要返回符合条件的第一条数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.findOne(&#123;userid:&quot;1003&quot;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>投影查询</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查询结果只显示 _id、userid、nickname</span><br><span class="line"># 默认 _id 会显示</span><br><span class="line"><span class="operator">&gt;</span> db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:<span class="number">1</span>,nickname:<span class="number">1</span>&#125;)</span><br><span class="line">&#123; &quot;_id&quot; : &quot;4&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot; &#125;</span><br><span class="line">&#123; &quot;_id&quot; : &quot;5&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot; &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果 <strong>要查询结果返回部分字段</strong>，则需要使用投影查询（不显示所有字段，只显示指定的字段）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 查询结果只显示 userid、nickname，不显示 _id</span><br><span class="line"><span class="operator">&gt;</span> db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:<span class="number">1</span>,nickname:<span class="number">1</span>,_id:<span class="number">0</span>&#125;)</span><br><span class="line">&#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot; &#125;</span><br><span class="line">&#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot; &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>注意</strong>：</p>
<p>批量插入由于数据较多容易出现失败，因此，可以使用 <code>try catch</code> 进行异常捕捉处理，测试的时候可以不处理</p>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">db.comment.insertMany([</span><br><span class="line">&#123;&quot;_id&quot;:&quot;1&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我们不应该把清晨浪费在手机上，健康很重要，一杯温水幸福你我他。&quot;,&quot;userid&quot;:&quot;1002&quot;,&quot;nickname&quot;:&quot;相忘于江湖&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-</span><br><span class="line">05T22:08:15.522Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">1000</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">&#123;&quot;_id&quot;:&quot;2&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我夏天空腹喝凉开水，冬天喝温开水&quot;,&quot;userid&quot;:&quot;1005&quot;,&quot;nickname&quot;:&quot;伊人憔悴&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-05T23:58:51.485Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">888</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">&#123;&quot;_id&quot;:&quot;3&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;我一直喝凉开水，冬天夏天都喝。&quot;,&quot;userid&quot;:&quot;1004&quot;,&quot;nickname&quot;:&quot;杰克船长&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T01:05:06.321Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">666</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">&#123;&quot;_id&quot;:&quot;4&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;专家说不能空腹吃饭，影响健康。&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;凯撒&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T08:18:35.288Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">2000</span>),&quot;state&quot;:&quot;1&quot;&#125;,</span><br><span class="line">&#123;&quot;_id&quot;:&quot;5&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;研究表明，刚烧开的水千万不能喝，因为烫嘴。&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;凯撒&quot;,&quot;createdatetime&quot;:<span class="keyword">new</span> <span class="type">Date</span>(&quot;2019-08-06T11:01:02.521Z&quot;),&quot;likenum&quot;:NumberInt(<span class="number">3000</span>),&quot;state&quot;:&quot;1&quot;&#125;</span><br><span class="line">]);</span><br><span class="line">	&#125; catch (e) &#123;</span><br><span class="line">		print (e);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="文档-的更新"><a class="headerlink" href="#文档-的更新"></a>文档 的更新</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">db.collection.update(query, <span class="keyword">update</span>, options)</span><br><span class="line"># query：查询条件</span><br><span class="line"># <span class="keyword">update</span>：更新条件</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">db.collection.update(</span><br><span class="line">	<span class="operator">&lt;</span>query<span class="operator">&gt;</span>,</span><br><span class="line">	<span class="operator">&lt;</span><span class="keyword">update</span><span class="operator">&gt;</span>,</span><br><span class="line">	&#123;</span><br><span class="line">		upsert: <span class="operator">&lt;</span><span class="type">boolean</span><span class="operator">&gt;</span>,</span><br><span class="line">		multi: <span class="operator">&lt;</span><span class="type">boolean</span><span class="operator">&gt;</span>,</span><br><span class="line">		writeConcern: <span class="operator">&lt;</span>document<span class="operator">&gt;</span>,</span><br><span class="line">		<span class="keyword">collation</span>: <span class="operator">&lt;</span>document<span class="operator">&gt;</span>,</span><br><span class="line">		arrayFilters: [ <span class="operator">&lt;</span>filterdocument1<span class="operator">&gt;</span>, ... ],</span><br><span class="line">		hint: <span class="operator">&lt;</span>document<span class="operator">|</span>string<span class="operator">&gt;</span> # Available starting <span class="keyword">in</span> MongoDB <span class="number">4.2</span></span><br><span class="line">	&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p><strong>覆盖修改</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.update(&#123;_id:&quot;1&quot;&#125;,&#123;likenum:NumberInt(<span class="number">1001</span>)&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>执行后会发现，这条文档 除了 likenum 字段 其它字段都不见了</li>
</ul>
<p><strong>局部修改</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.update(&#123;_id:&quot;1&quot;&#125;,&#123;$<span class="keyword">set</span>:&#123;likenum:NumberInt(<span class="number">1001</span>)&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>解决覆盖修改的问题，需要使用修改器 <code>$set</code> 来实现</li>
</ul>
<p><strong>批量修改</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 修改所有符合条件的数据</span><br><span class="line">db.comment.update(&#123;userid:&quot;1003&quot;&#125;,&#123;$<span class="keyword">set</span>:&#123;nickname:&quot;凯撒大帝&quot;&#125;&#125;,&#123;multi:<span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>提示：如果不加后面的参数，则只更新符合条件的第一条记录</li>
<li><strong>MongoDB 修改默认只修改 第一条数据</strong></li>
</ul>
<p><strong>列值增长的修改</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 对<span class="number">3</span>号数据的点赞数，每次递增<span class="number">1</span></span><br><span class="line">db.comment.update(&#123;_id:&quot;3&quot;&#125;,&#123;$inc:&#123;likenum:NumberInt(<span class="number">1</span>)&#125;&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>实现对某列值在原有值的基础上进行增加或减少，可以使用 <code>$inc</code> 运算符来实现</li>
</ul>
<hr>
<h4 id="文档-的-删除"><a class="headerlink" href="#文档-的-删除"></a>文档 的 删除</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.remove(条件)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p><strong>数据全部删除</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.remove(&#123;&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>删除 _id=1的记录</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.remove(&#123;_id:&quot;1&quot;&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="文档-的-分页查询"><a class="headerlink" href="#文档-的-分页查询"></a>文档 的 分页查询</h3>
<hr>
<h4 id="统计查询"><a class="headerlink" href="#统计查询"></a>统计查询</h4>
<hr>
<p>统计查询使用 <code>count()</code> 方法，<strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.<span class="built_in">count</span>(query, options)</span><br></pre></td></tr></table></figure>
<p><strong>参数说明</strong>：<img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240724085844703.png" alt="参数说明" loading="lazy"></p>
<p>eg：</p>
<p><strong>统计所有记录数</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.<span class="built_in">count</span>()</span><br></pre></td></tr></table></figure>
<p><strong>按条件统计记录数</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.<span class="built_in">count</span>(&#123;articleid:&quot;100001&quot;&#125;)</span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<hr>
<h4 id="分页列表查询"><a class="headerlink" href="#分页列表查询"></a>分页列表查询</h4>
<hr>
<p>使用 <code>limit()</code> 方法来 读取指定数量的数据，使用 <code>skip()</code> 方法来 跳过指定数量的数据</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find().limit(NUMBER).<span class="keyword">skip</span>(NUMBER)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p><strong>要返回指定条数的记录，可以在 find 方法后调用 limit 来返回结果（TopN），默认值 20</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find().limit(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><strong>skip 方法接受一个数字参数作为跳过的记录条数。（前N个不要），默认值是 0</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.find().<span class="keyword">skip</span>(<span class="number">3</span>)</span><br><span class="line">&#123; &quot;_id&quot; : &quot;4&quot;, &quot;articleid&quot; : &quot;100001&quot;, &quot;content&quot; : &quot;专家说不能空腹吃饭，影响健康。&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot;, &quot;createdatetime&quot; : ISODate(&quot;2019-08-06T08:18:35.288Z&quot;), &quot;likenum&quot; : <span class="number">2000</span>, &quot;state&quot; : &quot;1&quot; &#125;</span><br><span class="line">&#123; &quot;_id&quot; : &quot;5&quot;, &quot;articleid&quot; : &quot;100001&quot;, &quot;content&quot; : &quot;研究表明，刚烧开的水千万不能喝，因为烫嘴。&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot;, &quot;createdatetime&quot; : ISODate(&quot;2019-08-06T11:01:02.521Z&quot;), &quot;likenum&quot; : <span class="number">3000</span>, &quot;state&quot; : &quot;1&quot; &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="排序查询"><a class="headerlink" href="#排序查询"></a>排序查询</h4>
<hr>
<p>sort() 方法对数据进行排序，sort() 方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中：<strong>1 为 升序 排列，而 -1 是于 降序 排列</strong></p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find().sort(&#123;KEY:<span class="number">1</span>&#125;)</span><br><span class="line">或者</span><br><span class="line">db.集合名称.find().sort(排序方式)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p><strong>对 userid 降序排列，并对 访问量 进行升序排列</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find().sort(&#123;userid:<span class="number">-1</span>, likenum:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：</p>
<p><code>skip()</code>、<code>limilt()</code>、<code>sort()</code> 三个放在一起执行的时候，执行的顺序是 <strong>先 sort()</strong>，<strong>然后是 skip()</strong>，<strong>最后</strong>是显示的 <strong>limit()</strong>，和命令编写顺序无关</p>
<hr>
<h3 id="文档-的-复杂查询"><a class="headerlink" href="#文档-的-复杂查询"></a>文档 的 复杂查询</h3>
<hr>
<h4 id="正则的复杂条件查询"><a class="headerlink" href="#正则的复杂条件查询"></a>正则的复杂条件查询</h4>
<hr>
<p>MongoDB 的模糊查询是通过 正则表达式 的方式实现的</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&#123;field:<span class="operator">/</span>正则表达式<span class="operator">/</span>&#125;)</span><br><span class="line">或者</span><br><span class="line">db.集合.find(&#123;字段:<span class="operator">/</span>正则表达式<span class="operator">/</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p>查询评论内容包含 “开水” 的所有文档：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.find(&#123;content:<span class="operator">/</span>开水<span class="operator">/</span>&#125;)</span><br><span class="line">&#123; &quot;_id&quot; : &quot;2&quot;, &quot;articleid&quot; : &quot;100001&quot;, &quot;content&quot; : &quot;我夏天空腹喝凉开水，冬天喝温开水&quot;, &quot;userid&quot; : &quot;1005&quot;, &quot;nickname&quot; : &quot;伊人憔悴&quot;, &quot;createdatetime&quot; : ISODate(&quot;2019-08-05T23:58:51.485Z&quot;), &quot;likenum&quot; : <span class="number">888</span>, &quot;state&quot; : &quot;1&quot; &#125;</span><br><span class="line">&#123; &quot;_id&quot; : &quot;3&quot;, &quot;articleid&quot; : &quot;100001&quot;, &quot;content&quot; : &quot;我一直喝凉开水，冬天夏天都喝。&quot;, &quot;userid&quot; : &quot;1004&quot;, &quot;nickname&quot; : &quot;杰克船长&quot;, &quot;createdatetime&quot; : ISODate(&quot;2019-08-06T01:05:06.321Z&quot;), &quot;likenum&quot; : <span class="number">666</span>, &quot;state&quot; : &quot;1&quot; &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="比较查询"><a class="headerlink" href="#比较查询"></a>比较查询</h4>
<hr>
<p><code>&lt;</code>、<code>&lt;=</code>、<code>&gt;</code>、<code>&gt;=</code> 这种 操作符 是很常用的，<strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 大于: field <span class="operator">&gt;</span> <span class="keyword">value</span></span><br><span class="line">db.集合名称.find(&#123; &quot;field&quot; : &#123; $gt: <span class="keyword">value</span> &#125;&#125;)</span><br><span class="line"># 小于: field <span class="operator">&lt;</span> <span class="keyword">value</span></span><br><span class="line">db.集合名称.find(&#123; &quot;field&quot; : &#123; $lt: <span class="keyword">value</span> &#125;&#125;) </span><br><span class="line"># 大于等于: field <span class="operator">&gt;=</span> <span class="keyword">value</span></span><br><span class="line">db.集合名称.find(&#123; &quot;field&quot; : &#123; $gte: <span class="keyword">value</span> &#125;&#125;)</span><br><span class="line"># 小于等于: field <span class="operator">&lt;=</span> <span class="keyword">value</span></span><br><span class="line">db.集合名称.find(&#123; &quot;field&quot; : &#123; $lte: <span class="keyword">value</span> &#125;&#125;)</span><br><span class="line"># 不等于: field <span class="operator">!=</span> <span class="keyword">value</span></span><br><span class="line">db.集合名称.find(&#123; &quot;field&quot; : &#123; $ne: <span class="keyword">value</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p><strong>查询评论点赞数大于2500的记录</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.find(&#123;likenum:&#123;$gt:NumberInt(<span class="number">2500</span>)&#125;&#125;)</span><br><span class="line">&#123; &quot;_id&quot; : &quot;5&quot;, &quot;articleid&quot; : &quot;100001&quot;, &quot;content&quot; : &quot;研究表明，刚烧开的水千万不能喝，因为烫嘴。&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;凯撒&quot;, &quot;createdatetime&quot; : ISODate(&quot;2019-08-06T11:01:02.521Z&quot;), &quot;likenum&quot; : <span class="number">3000</span>, &quot;state&quot; : &quot;1&quot; &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="包含查询"><a class="headerlink" href="#包含查询"></a>包含查询</h4>
<hr>
<p><strong>包含 使用 $in 操作符</strong></p>
<p>eg：查询评论的集合中 userid 字段包含1003 或 1004 的文档</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&#123;$<span class="keyword">in</span>:[&quot;1003&quot;, &quot;1004&quot;]&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>不包含 使用 $nin 操作符</strong></p>
<p>eg：查询评论集合中 userid 字段不包含 1003 和 1004 的文档</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&#123;$nin:[&quot;1003&quot;, &quot;1004&quot;]&#125;&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="条件连接查询"><a class="headerlink" href="#条件连接查询"></a>条件连接查询</h4>
<hr>
<p>如果需要查询 同时满足两个以上条件，需要使用 <code>$and</code> 操作符将条件进行关联。（相当于 SQL 的 and）</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">and</span>:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ]</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p>查询评论集合中 likenum 大于等于 700 并且小于 2000 的文档</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;$<span class="keyword">and</span>:[&#123;likenum:&#123;$gte: NumberInt(<span class="number">700</span>)&#125;&#125;,&#123;likenum:&#123;$lt: NumberInt(<span class="number">2000</span>)&#125;&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<p>如果 两个以上条件之间是 或者 的关系，需要使用 <code>$or</code> 操作符将条件进行关联</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">or</span>:[ &#123; &#125;,&#123; &#125;,&#123; &#125;]</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<p>查询评论集合中 userid 为 1003，或者点赞数小于 1000 的文档记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;$<span class="keyword">or</span>:[&#123;userid: &quot;1003&quot;&#125;, &#123;likenum:&#123;$lt: NumberInt(<span class="number">1000</span>)&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>总结</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 选择切换数据库</span><br><span class="line">use articledb</span><br><span class="line"># 插入数据</span><br><span class="line">db.comment.insert(&#123;bson数据&#125;)</span><br><span class="line"># 查询所有数据</span><br><span class="line">db.comment.find();</span><br><span class="line"># 条件查询数据</span><br><span class="line">db.comment.find(&#123;条件&#125;)</span><br><span class="line"># 查询符合条件的第一条记录</span><br><span class="line">db.comment.findOne(&#123;条件&#125;)</span><br><span class="line"># 查询符合条件的前几条记录</span><br><span class="line">db.comment.find(&#123;条件&#125;).limit(条数)</span><br><span class="line"># 查询符合条件的跳过的记录</span><br><span class="line">db.comment.find(&#123;条件&#125;).<span class="keyword">skip</span>(条数)</span><br><span class="line"># 修改数据</span><br><span class="line">db.comment.update(&#123;条件&#125;,&#123;修改后的数据&#125;) 或 db.comment.update(&#123;条件&#125;,&#123;$<span class="keyword">set</span>:&#123;要修改部分的字段:数据&#125;)</span><br><span class="line"># 修改数据并自增某字段值</span><br><span class="line">db.comment.update(&#123;条件&#125;,&#123;$inc:&#123;自增的字段:步进值&#125;&#125;)</span><br><span class="line"># 删除数据</span><br><span class="line">db.comment.remove(&#123;条件&#125;)</span><br><span class="line"># 统计查询</span><br><span class="line">db.comment.<span class="built_in">count</span>(&#123;条件&#125;)</span><br><span class="line"># 模糊查询</span><br><span class="line">db.comment.find(&#123;字段名:<span class="operator">/</span>正则表达式<span class="operator">/</span>&#125;)</span><br><span class="line"># 条件比较运算</span><br><span class="line">db.comment.find(&#123;字段名:&#123;$gt:值&#125;&#125;)</span><br><span class="line"># 包含查询</span><br><span class="line">db.comment.find(&#123;字段名:&#123;$<span class="keyword">in</span>:[值<span class="number">1</span>，值<span class="number">2</span>]&#125;&#125;)或db.comment.find(&#123;字段名:&#123;$nin:[值<span class="number">1</span>，值<span class="number">2</span>]&#125;&#125;)</span><br><span class="line"># 条件连接查询</span><br><span class="line">db.comment.find(&#123;$<span class="keyword">and</span>:[&#123;条件<span class="number">1</span>&#125;,&#123;条件<span class="number">2</span>&#125;]&#125;)或db.comment.find(&#123;$<span class="keyword">or</span>:[&#123;条件<span class="number">1</span>&#125;,&#123;条件<span class="number">2</span>&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="索引"><a class="headerlink" href="#索引"></a>索引</h2>
<hr>
<p>MongoDB 索引使用 B树 数据结构（确切的说是 B-Tree，MySQL是 B+Tree）</p>
<hr>
<h3 id="索引的分类"><a class="headerlink" href="#索引的分类"></a>索引的分类</h3>
<hr>
<ol>
<li>单字段索引
<ul>
<li>MongoDB 支持在文档的单个字段上创建用户定义的 升序/降序 索引</li>
</ul>
</li>
<li>复合索引
<ul>
<li>支持多个字段的用户定义索引</li>
</ul>
</li>
<li>地理空间索引（Geospatial Index）</li>
<li>文本索引（Text Indexes）</li>
<li>哈希索引（Hashed Indexes）</li>
</ol>
<hr>
<h3 id="索引的管理操作"><a class="headerlink" href="#索引的管理操作"></a>索引的管理操作</h3>
<hr>
<h4 id="查看索引"><a class="headerlink" href="#查看索引"></a>查看索引</h4>
<hr>
<p>返回 一个集合中 的 所有索引 的 数组</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.getIndexes()</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.getIndexes()</span><br><span class="line">[ &#123; &quot;v&quot; : <span class="number">2</span>, &quot;key&quot; : &#123; &quot;_id&quot; : <span class="number">1</span> &#125;, &quot;name&quot; : &quot;_id_&quot; &#125; ]</span><br></pre></td></tr></table></figure>
<ul>
<li>结果中显示的是默认 <code>_id</code> 索引</li>
</ul>
<p>注意：该索引是唯一索引，因此值不能重复，即 <code>_id</code> 值不能重复的。在分片集群中，通常使用 <code>_id</code> 作为片键</p>
<hr>
<h4 id="创建索引"><a class="headerlink" href="#创建索引"></a>创建索引</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.createIndex(keys, options)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>参数说明</strong>：<img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240724101209208.png" alt="keys" loading="lazy"></p>
<p><img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240724101304752.png" alt="options" loading="lazy"></p>
</li>
</ul>
<p>eg：</p>
<p>对 userid 字段建立一个升序的索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.createIndex(&#123;userid:<span class="number">1</span>&#125;)</span><br><span class="line">&#123;</span><br><span class="line">	&quot;numIndexesBefore&quot; : <span class="number">1</span>,</span><br><span class="line">	&quot;numIndexesAfter&quot; : <span class="number">2</span>,</span><br><span class="line">	&quot;createdCollectionAutomatically&quot; : <span class="literal">false</span>,</span><br><span class="line">	&quot;ok&quot; : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对 userid 和 nickname 同时建立 复合索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.createIndex(&#123;userid:<span class="number">1</span>, nickname:<span class="number">-1</span>&#125;)</span><br><span class="line">&#123;</span><br><span class="line">	&quot;numIndexesBefore&quot; : <span class="number">2</span>,</span><br><span class="line">	&quot;numIndexesAfter&quot; : <span class="number">3</span>,</span><br><span class="line">	&quot;createdCollectionAutomatically&quot; : <span class="literal">false</span>,</span><br><span class="line">	&quot;ok&quot; : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="删除索引"><a class="headerlink" href="#删除索引"></a>删除索引</h4>
<hr>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.dropIndex(index)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>参数说明</strong>：<img src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/image-20240724101745362.png" alt="index" loading="lazy"></li>
</ul>
<p>eg：</p>
<p>删除 comment 集合中 userid 字段上的升序索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.dropIndex(&#123;userid:<span class="number">1</span>&#125;)</span><br><span class="line">&#123; &quot;nIndexesWas&quot; : <span class="number">3</span>, &quot;ok&quot; : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>所有索引的移除</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.dropIndexes()</span><br><span class="line">&#123;</span><br><span class="line">	&quot;nIndexesWas&quot; : <span class="number">2</span>,</span><br><span class="line">	&quot;msg&quot; : &quot;non-_id indexes dropped for collection&quot;,</span><br><span class="line">	&quot;ok&quot; : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>提示： <code>_id</code> 的字段的索引是无法删除的，只能删除非 <code>_id</code> 字段的索引</li>
</ul>
<hr>
<h3 id="索引的使用"><a class="headerlink" href="#索引的使用"></a>索引的使用</h3>
<hr>
<h4 id="执行计划"><a class="headerlink" href="#执行计划"></a>执行计划</h4>
<hr>
<p>分析查询性能（Analyze Query Performance）通常使用执行计划（解释计划、Explain Plan）来查看查询的情况，如：查询耗费的时间、是否基于索引查询等</p>
<p><strong>基本语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(query, options).explain(options)</span><br></pre></td></tr></table></figure>
<p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.comment.find(&#123;userid:&quot;1003&quot;&#125;).explain()</span><br><span class="line">&#123;</span><br><span class="line">	&quot;explainVersion&quot; : &quot;1&quot;,</span><br><span class="line">	&quot;queryPlanner&quot; : &#123;</span><br><span class="line">		&quot;namespace&quot; : &quot;test.comment&quot;,</span><br><span class="line">		&quot;indexFilterSet&quot; : <span class="literal">false</span>,</span><br><span class="line">		&quot;parsedQuery&quot; : &#123;</span><br><span class="line">			&quot;userid&quot; : &#123;</span><br><span class="line">				&quot;$eq&quot; : &quot;1003&quot;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;queryHash&quot; : &quot;37A12FC3&quot;,</span><br><span class="line">		&quot;planCacheKey&quot; : &quot;4A7D843D&quot;,</span><br><span class="line">		&quot;maxIndexedOrSolutionsReached&quot; : <span class="literal">false</span>,</span><br><span class="line">		&quot;maxIndexedAndSolutionsReached&quot; : <span class="literal">false</span>,</span><br><span class="line">		&quot;maxScansToExplodeReached&quot; : <span class="literal">false</span>,</span><br><span class="line">		&quot;winningPlan&quot; : &#123;</span><br><span class="line">			&quot;stage&quot; : &quot;COLLSCAN&quot;, # &quot;stage&quot; : &quot;COLLSCAN&quot;：表示全集合扫描</span><br><span class="line">			#  &quot;stage&quot; : &quot;IXSCAN&quot;：表示基于索引的扫描</span><br><span class="line">			&quot;filter&quot; : &#123;</span><br><span class="line">				&quot;userid&quot; : &#123;</span><br><span class="line">					&quot;$eq&quot; : &quot;1003&quot;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			&quot;direction&quot; : &quot;forward&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;rejectedPlans&quot; : [ ]</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;command&quot; : &#123;</span><br><span class="line">		&quot;find&quot; : &quot;comment&quot;,</span><br><span class="line">		&quot;filter&quot; : &#123;</span><br><span class="line">			&quot;userid&quot; : &quot;1003&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;$db&quot; : &quot;test&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;serverInfo&quot; : &#123;</span><br><span class="line">		&quot;host&quot; : &quot;0ffd0a5d537d&quot;,</span><br><span class="line">		&quot;port&quot; : <span class="number">27017</span>,</span><br><span class="line">		&quot;version&quot; : &quot;5.0.5&quot;,</span><br><span class="line">		&quot;gitVersion&quot; : &quot;d65fd89df3fc039b5c55933c0f71d647a54510ae&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;serverParameters&quot; : &#123;</span><br><span class="line">		&quot;internalQueryFacetBufferSizeBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalQueryFacetMaxOutputDocSizeBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalLookupStageIntermediateDocumentMaxSizeBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalDocumentSourceGroupMaxMemoryBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalQueryMaxBlockingSortMemoryUsageBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalQueryProhibitBlockingMergeOnMongoS&quot; : <span class="number">0</span>,</span><br><span class="line">		&quot;internalQueryMaxAddToSetBytes&quot; : <span class="number">104857600</span>,</span><br><span class="line">		&quot;internalDocumentSourceSetWindowFieldsMaxMemoryBytes&quot; : <span class="number">104857600</span></span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;ok&quot; : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="涵盖的查询"><a class="headerlink" href="#涵盖的查询"></a>涵盖的查询</h4>
<hr>
<p>当查询条件和查询的投影仅包含索引字段时，MongoDB 直接从索引返回结果，而不扫描任何文档或将文档带入内存，这些覆盖的查询可以非常有效</p>
<p>详情见连接：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/query-optimization/">查询优化 - MongoDB 手册 v7.0</a></p>
<hr>
<h2 id="SpringDataMongoDB"><a class="headerlink" href="#SpringDataMongoDB"></a>SpringDataMongoDB</h2>
<hr>
<p>SpringData 家族成员之一，用于操作 MongoDB 的持久层框架，封装了底层的 mongodb-driver</p>
<p>官网主页： <a target="_blank" rel="noopener" href="https://projects.spring.io/spring-data-mongodb/">https://projects.spring.io/spring-data-mongodb/</a></p>
<h3 id="使用流程"><a class="headerlink" href="#使用流程"></a>使用流程</h3>
<ol>
<li>
<p>导入相关依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>创建 application.yml</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment">#数据源配置</span></span><br><span class="line">  <span class="attr">data:</span></span><br><span class="line">    <span class="attr">mongodb:</span></span><br><span class="line">      <span class="comment"># 主机地址</span></span><br><span class="line">      <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.88</span><span class="number">.129</span></span><br><span class="line">      <span class="comment"># 数据库</span></span><br><span class="line">      <span class="attr">database:</span> <span class="string">test</span></span><br><span class="line">      <span class="comment"># 默认端口是27017</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">27017</span></span><br><span class="line">      <span class="comment">#也可以使用uri连接</span></span><br><span class="line">      <span class="comment">#uri: mongodb://192.168.88.129:27017/test</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>创建启动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArticleApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ArticleApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>创建一个 article 的实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文章评论实体类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 把一个java类声明为mongodb的文档，可以通过collection参数指定这个类对应的文档。</span></span><br><span class="line"><span class="comment">// @Document(collection=&quot;mongodb 对应 collection 名&quot;)</span></span><br><span class="line"><span class="comment">// 若未加 @Document ，该 bean save 到 mongo 的 comment collection</span></span><br><span class="line"><span class="comment">// 若添加 @Document ，则 save 到 comment collection</span></span><br><span class="line"><span class="meta">@Document(collection = &quot;comment&quot;)</span> <span class="comment">// 可以省略，如果省略，则默认使用类名小写映射集合</span></span><br><span class="line"><span class="comment">// 复合索引</span></span><br><span class="line"><span class="meta">@CompoundIndex(def = &quot;&#123;&#x27;userid&#x27;: 1, &#x27;nickname&#x27;: -1&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Comment</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">// 主键标识，该属性的值会自动对应mongodb的主键字段&quot;_id&quot;，如果该属性名就叫“id”,则该注解可以省略，否则必须写</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> String id; <span class="comment">//主键</span></span><br><span class="line">    <span class="comment">// 该属性对应mongodb的字段的名字，如果一致，则无需该注解</span></span><br><span class="line">    <span class="meta">@Field(&quot;content&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String content; <span class="comment">//吐槽内容</span></span><br><span class="line">    <span class="keyword">private</span> Date publishtime; <span class="comment">//发布日期</span></span><br><span class="line">    <span class="comment">// 添加了一个单字段的索引</span></span><br><span class="line">    <span class="meta">@Indexed</span></span><br><span class="line">    <span class="keyword">private</span> String userid; <span class="comment">// 发布人ID</span></span><br><span class="line">    <span class="keyword">private</span> String nickname; <span class="comment">// 昵称</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createdatetime; <span class="comment">// 评论的日期时间</span></span><br><span class="line">    <span class="keyword">private</span> Integer likenum; <span class="comment">// 点赞数</span></span><br><span class="line">    <span class="keyword">private</span> Integer replynum; <span class="comment">// 回复数</span></span><br><span class="line">    <span class="keyword">private</span> String state; <span class="comment">// 状态</span></span><br><span class="line">    <span class="keyword">private</span> String parentid; <span class="comment">// 上级ID</span></span><br><span class="line">    <span class="keyword">private</span> String articleid;</span><br><span class="line">    <span class="comment">// getter and setter.....</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContent</span><span class="params">(String content)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getPublishtime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> publishtime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPublishtime</span><span class="params">(Date publishtime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.publishtime = publishtime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserid</span><span class="params">(String userid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userid = userid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getNickname</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> nickname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNickname</span><span class="params">(String nickname)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.nickname = nickname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LocalDateTime <span class="title function_">getCreatedatetime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdatetime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedatetime</span><span class="params">(LocalDateTime createdatetime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdatetime = createdatetime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getLikenum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> likenum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLikenum</span><span class="params">(Integer likenum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.likenum = likenum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getReplynum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> replynum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setReplynum</span><span class="params">(Integer replynum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.replynum = replynum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(String state)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getParentid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> parentid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParentid</span><span class="params">(String parentid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.parentid = parentid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getArticleid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> articleid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setArticleid</span><span class="params">(String articleid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.articleid = articleid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Comment&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&#x27;&quot;</span> + id + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, content=&#x27;&quot;</span> + content + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, publishtime=&quot;</span> + publishtime +</span><br><span class="line">                <span class="string">&quot;, userid=&#x27;&quot;</span> + userid + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, nickname=&#x27;&quot;</span> + nickname + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, createdatetime=&quot;</span> + createdatetime +</span><br><span class="line">                <span class="string">&quot;, likenum=&quot;</span> + likenum +</span><br><span class="line">                <span class="string">&quot;, replynum=&quot;</span> + replynum +</span><br><span class="line">                <span class="string">&quot;, state=&#x27;&quot;</span> + state + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, parentid=&#x27;&quot;</span> + parentid + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, articleid=&#x27;&quot;</span> + articleid + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>说明</strong>：</p>
<p>索引可以大大提升查询效率，一般在查询字段上添加索引，索引的添加可以通过 Mongo 的命令来添加，也可以在 Java 的实体类中通过注解添加</p>
<ul>
<li>单字段索引注解 <code>@Indexed</code></li>
<li>复合索引注解 <code>@CompoundIndex</code></li>
</ul>
</li>
</ol>
<hr>
<p><strong>未完待续 …</strong></p>
</article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/MyPhoto.jpg"></a><div class="post-copyright__author_name">coo1heisenberg's Blog</div><div class="post-copyright__author_desc">Diligence can make up for clumsiness!</div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本文是原创文章，采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>协议，完整转载请注明来自<a href="/">coo1heisenberg's Blog</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MongoDB/"><span class="tags-punctuation"></span>MongoDB<span class="tagsPageCount">1</span></a></div></div><div class="social-share"></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/29/Java-%E7%BA%BF%E7%A8%8B/"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">00 JavaBasic_线程相关</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/17/00-elasticsearch/"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">00 ElasticSearch 笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">sayhello.morning</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="头像" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/MyPhoto.jpg"><div class="avatar-sticker"><img class="avatar-sticker-img" src="https://7.isyangs.cn/34/65f2e4e0423cc-34.png" alt="心情贴纸"></div></div><div class="author-info__description_group"><div class="author-info__description">菜鸡的自我救赎...</div><div class="author-info__description2"></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about/"><div class="author-info__name">Coo1heisenberg’s BLOG</div><div class="author-info__desc">Diligence can make up for clumsiness!</div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="noopener" href="https://github.com/coo1heisenbergProject" title="Github"><i class="solitude  st-github-line"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="solitude st-menu-line"></i><span>文章目录</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-text">MongoDB 相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB-%E7%AE%80%E4%BB%8B"><span class="toc-text">MongoDB 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text">MongoDB 数据模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB-%E7%89%B9%E7%82%B9"><span class="toc-text">MongoDB 特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">基本常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9-%E5%92%8C-%E5%88%9B%E5%BB%BA-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">选择 和 创建 数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">删除 数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88-%E6%93%8D%E4%BD%9C"><span class="toc-text">集合 操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88-%E7%9A%84-%E6%98%BE%E5%BC%8F%E5%88%9B%E5%BB%BA"><span class="toc-text">集合 的 显式创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88-%E7%9A%84-%E5%88%A0%E9%99%A4"><span class="toc-text">集合 的 删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E5%9F%BA%E6%9C%AC-CRUD"><span class="toc-text">文档基本 CRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84-%E6%8F%92%E5%85%A5"><span class="toc-text">文档 的 插入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84-%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="toc-text">文档 的 基本查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-text">文档 的更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84-%E5%88%A0%E9%99%A4"><span class="toc-text">文档 的 删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">文档 的 分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E6%9F%A5%E8%AF%A2"><span class="toc-text">统计查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E5%88%97%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">分页列表查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-text">排序查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3-%E7%9A%84-%E5%A4%8D%E6%9D%82%E6%9F%A5%E8%AF%A2"><span class="toc-text">文档 的 复杂查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E7%9A%84%E5%A4%8D%E6%9D%82%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text">正则的复杂条件查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E6%9F%A5%E8%AF%A2"><span class="toc-text">比较查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%9F%A5%E8%AF%A2"><span class="toc-text">包含查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">条件连接查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">索引的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C"><span class="toc-text">索引的管理操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95"><span class="toc-text">查看索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-text">创建索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-text">删除索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">索引的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-text">执行计划</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%B5%E7%9B%96%E7%9A%84%E6%9F%A5%E8%AF%A2"><span class="toc-text">涵盖的查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringDataMongoDB"><span class="toc-text">SpringDataMongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="toc-text">使用流程</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="solitude st-map-line"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/13/00-%E5%8D%95%E7%BB%86%E8%83%9E%E5%A4%9A%E7%BB%84%E5%AD%A6%E5%88%86%E6%9E%90/" title="00-单细胞多组学分析"><img alt="00-单细胞多组学分析" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/bio_gene.png"></a><div class="content"><a class="title" href="/2024/09/13/00-%E5%8D%95%E7%BB%86%E8%83%9E%E5%A4%9A%E7%BB%84%E5%AD%A6%E5%88%86%E6%9E%90/" title="00-单细胞多组学分析">00-单细胞多组学分析</a><a class="article-recent_post_categories" href="/2024/09/13/00-%E5%8D%95%E7%BB%86%E8%83%9E%E5%A4%9A%E7%BB%84%E5%AD%A6%E5%88%86%E6%9E%90/">单细胞多组学分析</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/29/Java-%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="03 JavaBasic_类加载及反射"><img alt="03 JavaBasic_类加载及反射" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/JavaLog.png"></a><div class="content"><a class="title" href="/2024/08/29/Java-%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="03 JavaBasic_类加载及反射">03 JavaBasic_类加载及反射</a><a class="article-recent_post_categories" href="/2024/08/29/Java-%E7%B1%BB%E5%8A%A0%E8%BD%BD/">Java</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/29/Java-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="02 JavaBasic_网络编程"><img alt="02 JavaBasic_网络编程" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/JavaLog.png"></a><div class="content"><a class="title" href="/2024/08/29/Java-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="02 JavaBasic_网络编程">02 JavaBasic_网络编程</a><a class="article-recent_post_categories" href="/2024/08/29/Java-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">Java</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/29/Java-IO%E6%B5%81/" title="01 JavaBasic_IO流"><img alt="01 JavaBasic_IO流" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/JavaLog.png"></a><div class="content"><a class="title" href="/2024/08/29/Java-IO%E6%B5%81/" title="01 JavaBasic_IO流">01 JavaBasic_IO流</a><a class="article-recent_post_categories" href="/2024/08/29/Java-IO%E6%B5%81/">Java</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/29/Java-%E7%BA%BF%E7%A8%8B/" title="00 JavaBasic_线程相关"><img alt="00 JavaBasic_线程相关" src="https://coo1heisenberg-blog.oss-cn-shanghai.aliyuncs.com/JavaLog.png"></a><div class="content"><a class="title" href="/2024/08/29/Java-%E7%BA%BF%E7%A8%8B/" title="00 JavaBasic_线程相关">00 JavaBasic_线程相关</a><a class="article-recent_post_categories" href="/2024/08/29/Java-%E7%BA%BF%E7%A8%8B/">Java</a></div></div></div></div></div></div></main><footer id="footer"><div id="st-footer-bar"><div class="footer-logo"><span>Solitude</span></div><div class="footer-bar-description">来自 Heisenberg 的原创文章</div><a class="footer-bar-link" href="/about/">了解更多</a></div><div id="footer_deal"></div><div id="st-footer"><div class="footer-group"><h3 class="footer-title">导航</h3><div class="footer-links"><a class="footer-item" href="/archives/" title="归档">归档</a><a class="footer-item" href="/categories/" title="分类">分类</a><a class="footer-item" href="/tags/" title="标签">标签</a></div></div><div class="footer-group"><h3 class="footer-title">服务</h3><div class="footer-links"><a class="footer-item" target="_blank" rel="noopener" href="https://aliyun.com/" title="阿里云">阿里云</a></div></div><div class="footer-group"><h3 class="footer-title">支持</h3><div class="footer-links"><a class="footer-item" href="/about/" title="打赏记录">打赏记录</a></div></div><div class="footer-group"><h3 class="footer-title">协议</h3><div class="footer-links"><a class="footer-item" href="/cookies/" title="Cookies">Cookies</a><a class="footer-item" href="/privacy/" title="用户协议">用户协议</a><a class="footer-item" href="/copyright/" title="版权协议">版权协议</a></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">© 2024 By&nbsp;<a class="footer-bar-link" href="/">Coo1heisenberg’s BLOG</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/valor-x/hexo-theme-solitude" alt="主题">主题</a><a class="footer-bar-link cc" href="/null" aria-label="copyright"><i class="solitude st-copyright-line"></i><i class="solitude st-creative-commons-by-line"></i><i class="solitude st-creative-commons-nc-line"></i><i class="solitude st-creative-commons-nd-line"></i></a></div></div></div></footer></div><!-- right_menu--><!-- inject body--><div><script src="/js/utils.js?v=1.10.6"></script><script src="/js/main.js?v=1.10.6"></script><script src="/js/third_party/waterfall.min.js?v=1.10.6"></script><script src="//open.lightxi.com/cdnjs/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/third_party/universe.min.js?v=1.10.6"></script><script>dark()
</script><script src="//open.lightxi.com/cdnjs/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js"><script>(() => {
    document.querySelectorAll('#article-container span.katex-display').forEach(item => {
        utils.wrap(item, 'div', {class: 'katex-wrap'})
    })
})();
</script></script><script src="//open.lightxi.com/cdnjs/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script src="//open.lightxi.com/cdnjs/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script><script>var meting_api = 'https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r';</script><script src="//open.lightxi.com/cdnjs/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="//open.lightxi.com/cdnjs/ajax/libs/meting/2.0.1/Meting.min.js"></script><script src="//open.lightxi.com/cdnjs/ajax/libs/pace/1.2.4/pace.min.js"></script><div class="js-pjax"><script defer pjax src="//open.lightxi.com/cdnjs/ajax/libs/busuanzi/2.3.0/bsz.pure.mini.min.js"></script></div></div><!-- newest comment--><!-- pjax--><script>const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: ['title','#body-wrap','#site-config','meta[name="description"]','.js-pjax','meta[property^="og:"]','#config-diff'],
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()

    document.querySelectorAll('script[data-pjax]').forEach(item => {
        const newScript = document.createElement('script')
        const content = item.text || item.textContent || item.innerHTML || ""
        Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
        newScript.appendChild(document.createTextNode(content))
        item.parentNode.replaceChild(newScript, item)
    })

    GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- theme--><script>initTheme = () => {
    let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const cachedMode = utils.saveToLocal.get('theme');
    if (cachedMode === undefined) {
        const nowMode =
            isDarkMode ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', nowMode);
    } else {
        document.documentElement.setAttribute('data-theme', cachedMode);
    }
    is_rm && rm.mode(cachedMode === 'dark' && isDarkMode)
}
initTheme()</script><!-- google adsense--><!-- search--><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="solitude st-close-fill"></i></button></nav><div class="search-wrap"><div class="search-box"><input class="search-box-input" id="search-input" type="text" autocomplete="off" spellcheck="false" autocorrect="off" autocapitalize="off" placeholder="输入关键词快速查找"></div><div id="search-results"><div id="search-hits"></div></div><div id="search-pagination"></div><div id="search-tips"></div></div></div><div id="search-mask"></div></div><script src="/js/search/local.js?v=1.10.6"></script><!-- Tianli-Talk--><!-- music--></body></html><script>const posts=["2024/09/13/00-单细胞多组学分析/","2024/08/29/Java-类加载/","2024/08/29/Java-网络编程/","2024/08/29/Java-IO流/","2024/08/29/Java-线程/","2024/07/22/00-MongoDB/","2024/07/17/00-elasticsearch/","2024/07/15/01-黑马redis/","2024/07/13/00-黑马redis/","2024/07/08/00-黑马SSM/","2024/07/08/01-头条点评项目/","2024/07/06/00-Mybatis-Plus/","2024/06/29/00-黑马MySQL/","2024/06/25/00-头条点评项目/","2024/06/21/02-Python/","2024/06/11/01-Python/","2024/05/25/00-Python/","2024/05/13/DesignPattern/","2024/05/13/Docker/","2024/05/13/Nginx/","2024/05/13/Linux/","2024/05/13/Spring-Cloud/","2024/05/13/Spring-boot/","2024/05/13/Spring-MVC/","2024/05/13/Spring事务/","2024/05/13/Spring-AOP/","2024/05/13/Spring-IOC-DI/","2024/05/13/JavaEE-MVC/","2024/05/13/JavaEE-WebTools/","2024/05/13/JavaEE-conversation/","2024/05/13/JavaEE-response/","2024/05/13/JavaEE-request/","2024/05/13/JavaEE-Servlet/"];function toRandomPost(){ pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]); }</script>